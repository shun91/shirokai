google.load("feeds","1");function writeGatcha(t,s,r,q,n){if(void 0===s||null==s){s="side-";}if(void 0===n||null==n||1!=n){n=!1;}var o=null;if("category"==r){var p=document.querySelectorAll("div.categories a");if(null!=p&&0<p.length){for(var o=[],m=0;m<p.length;m++){var j=p[m].href,i=j.replace(getBlogUrl(),"");console.log(i);0>i.indexOf("-")&&0<=j.indexOf(getBlogUrl()+"/archive/category/")&&o.push(p[m]);}m=Math.floor(Math.random()*o.length);o=o[m];}}p="";p=void 0!==o&&null!=o?o.href.replace(getBlogUrl()+"/archive/category/",""):"all"==r?"gatcha-all":"recent"==r?"gatcha-new":"";void 0!==q&&null!=q?(document.write('<div class="hatena-module-foot gatcha-box"><div class="hatena-module-title">'+q),500<window.innerWidth?(document.write('<span style="float:right">'),writeForm(s,p,t,n),document.write("</span></div>")):(document.write("</h3>"),writeForm(s,p,t)),document.write("</div>")):writeForm(s,p,t);document.write('<span id="'+s+'gachaSpan"></span>');switchGatchButton(!1,s);}function writeForm(f,e,h,g){f=document.getElementById(f+"inGatchaCategory");f.appendChild(createOption("gatcha-all","\u5168\u3066"));f.appendChild(createOption("gatcha-rare","\u4eba\u6c17"));f.appendChild(createOption("gatcha-new","\u6700\u65b0"));f.selectedIndex=1;}function writeGatchaCategory(e){if(void 0===e||null==e){e="side-";}var d=getBlogUrl(),f=new google.feeds.Feed("http://pipes.yahoo.com/pipes/pipe.run?&blog="+d+"&_id=31da73e0525591d9dd0c0702856a3b5b&_render=rss");f.setNumEntries(100);f.load(function(g){var h=document.getElementById(e+"inGatchaCategory"),a=[];!g.error&&0<g.feed.entries.length&&(a=g.feed.entries);for(g=0;g<a.length;g++){var b=a[g];0<=b.link.replace(getBlogUrl(),"").indexOf("-")||(b=createOption(b.link.replace(d+"/category/",""),b.title),h.appendChild(b));}console.log(h);a=!1;b=document.getElementById(e+"mode");for(g=0;g<h.options.length;g++){if(h.options[g].value==b.value){a=h.options[g].selected=!0;break;}}a||null==b.value||""==b.value||(g=b.value.replace(d+"/archive/category/",""),b=createOption(g,decodeURI(g)),h.appendChild(b),b.selected=!0);runGatcha(e);});}function createOption(e,d){var f=document.createElement("option");f.value=e;f.text=d;return f;}function switchGatchButton(e,d){document.getElementById(d+"btnNormalGatcha").disabled=!e;document.getElementById(d+"btnMoveGatcha").disabled=!e;document.getElementById(d+"inGatchaCategory").disabled=!e;var f=document.getElementById(d+"btnFeedlyGatcha");null!=f&&(f.disabled=!e);}function feedGatcha(f){switchGatchButton(!1,f);var e="",e=getBlogUrl(),h=document.getElementById(f+"inGatchaCategory"),g=h.selectedIndex,e=0==g||2==g?e+"/feed":1==g?"http://b.hatena.ne.jp/entrylist?sort=count&mode=rss&url="+encodeURIComponent(e):e+"/rss/category/"+h.value;switchGatchButton(!0,f);window.open("http://cloud.feedly.com/#subscription%2Ffeed%2F"+encodeURIComponent(e));}function moveGatcha(f){switchGatchButton(!1,f);var e="",e=getBlogUrl(),h=document.getElementById(f+"inGatchaCategory"),g=h.selectedIndex,e=0==g||2==g?e+"/archive":1==g?"http://b.hatena.ne.jp/entrylist?sort=count&url="+encodeURIComponent(e):e+"/archive/category/"+h.value;switchGatchButton(!0,f);location.href=e;}function runGatcha(e){switchGatchButton(!1,e);var d=document.getElementById(e+"inGatchaCategory"),f=d.selectedIndex;0==f?runNormalGatcha(e):1==f?runRareGatcha(e):2==f?runNewGatcha(e):runCategoryGatcha(e,d.value);switchGatchButton(!0,e);}function runCommonGatcha(f,e){var h=document.getElementById(f+"inGatchaNum").value,g=new google.feeds.Feed(e);g.setNumEntries(50);g.load(function(a){var c=[];!a.error&&0<a.feed.entries.length&&(c=a.feed.entries);c=removeThisEntry(c);a=document.getElementById(f+"gachaSpan");createOwnHtml(a,null,c,null,h);});}function runNewGatcha(d){var c=getBlogUrl();runCommonGatcha(d,c+"/rss");}function runRareGatcha(d){var c=getBlogUrl(),c="http://b.hatena.ne.jp/entrylist?sort=count&mode=rss&url="+encodeURIComponent(c);runCommonGatcha(d,c);}function runCategoryGatcha(e,d){var f=getBlogUrl()+"/rss/category/"+d;runCommonGatcha(e,f);}function runNormalGatcha(j){for(var i=document.getElementById(j+"inGatchaNum").value,p=getBlogUrl(),o=[],l=1;10>=l;l++){var m="http://pipes.yahoo.com/pipes/pipe.run?url="+encodeURIComponent(p+"/sitemap.xml?page="+l)+"&_id=f48751a13b81b177ba69aa786f7354bf&_render=rss";o.push(new google.feeds.Feed(m));}for(var n=[],k=0,l=0;l<o.length;l++){o[l].setNumEntries(100),o[l].load(function(a){a.error||0==a.feed.entries.length||(n=n.concat(a.feed.entries));++k==o.length&&(n=removeThisEntry(n),a=document.getElementById(j+"gachaSpan"),createOwnHtml(a,null,n,null,i));});}}